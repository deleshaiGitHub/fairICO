<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hedgehog Token Staking</title>
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f9;
            color: #333;
        }
        .container {
            width: 80%;
            margin: 0 auto;
            padding: 20px;
        }
        .section {
            margin-bottom: 20px;
        }
        button {
            padding: 10px 20px;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:disabled {
            background-color: #cccccc;
        }
        input {
            padding: 10px;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Hedgehog Token Staking</h1>

        <div class="section" id="landing">
            <h2>Overview</h2>
            <p>Total Tokens Staked: <span id="totalStaked">0</span></p>
            <p>Reward Rate: <span id="rewardRate">10%</span></p>
            <p>Lock Period: <span id="lockPeriod">5 minutes</span></p>
        </div>

        <div class="section" id="stake">
            <h2>Stake Tokens</h2>
            <input type="number" id="stakeAmount" placeholder="Amount to Stake">
            <button id="approveButton">Approve</button>
            <button id="stakeButton" disabled>Stake</button>
        </div>

        <div class="section" id="claim">
            <h2>Claim Rewards</h2>
            <p>Rewards Earned: <span id="rewards">0</span></p>
            <button id="claimButton" disabled>Claim Rewards</button>
        </div>

        <div class="section" id="unstake">
            <h2>Unstake Tokens</h2>
            <p>Staked Amount: <span id="stakedAmount">0</span></p>
            <p>Unlock Time: <span id="unlockTime">Not yet unlocked</span></p>
            <button id="unstakeButton" disabled>Unstake</button>
        </div>
    </div>

    <script>
        const stakingAddress = "<STAKING_CONTRACT_ADDRESS>";
        const tokenAddress = "<TOKEN_CONTRACT_ADDRESS>";
        let provider, signer, stakingContract, tokenContract;

        async function init() {
            if (!window.ethereum) {
                alert("Please install MetaMask!");
                return;
            }

            provider = new ethers.providers.Web3Provider(window.ethereum);
            signer = provider.getSigner();

            const stakingAbi = [
                "function stake(uint256 amount) external",
                "function claimRewards() external",
                "function unstake() external",
                "function calculateReward(address user) public view returns (uint256)",
                "function stakes(address user) public view returns (uint256 amount, uint256 startTime, uint256 lastClaimTime)"
            ];

            const tokenAbi = [
                "function approve(address spender, uint256 amount) public returns (bool)",
                "function allowance(address owner, address spender) public view returns (uint256)",
                "function balanceOf(address owner) public view returns (uint256)"
            ];

            stakingContract = new ethers.Contract(stakingAddress, stakingAbi, signer);
            tokenContract = new ethers.Contract(tokenAddress, tokenAbi, signer);

            document.getElementById("approveButton").onclick = approveTokens;
            document.getElementById("stakeButton").onclick = stakeTokens;
            document.getElementById("claimButton").onclick = claimRewards;
            document.getElementById("unstakeButton").onclick = unstakeTokens;

            updateUI();
        }

        async function approveTokens() {
            const amount = document.getElementById("stakeAmount").value;
            const tx = await tokenContract.approve(stakingAddress, ethers.utils.parseUnits(amount, 18));
            await tx.wait();
            alert("Tokens approved!");
            document.getElementById("stakeButton").disabled = false;
        }

        async function stakeTokens() {
            const amount = document.getElementById("stakeAmount").value;
            const tx = await stakingContract.stake(ethers.utils.parseUnits(amount, 18));
            await tx.wait();
            alert("Tokens staked!");
            updateUI();
        }

        async function claimRewards() {
            const tx = await stakingContract.claimRewards();
            await tx.wait();
            alert("Rewards claimed!");
            updateUI();
        }

        async function unstakeTokens() {
            const tx = await stakingContract.unstake();
            await tx.wait();
            alert("Tokens unstaked!");
            updateUI();
        }

        async function updateUI() {
            const [stakedAmount, startTime, lastClaimTime] = await stakingContract.stakes(await signer.getAddress());
            const rewards = await stakingContract.calculateReward(await signer.getAddress());

            document.getElementById("stakedAmount").innerText = ethers.utils.formatUnits(stakedAmount, 18);
            document.getElementById("rewards").innerText = ethers.utils.formatUnits(rewards, 18);

            const unlockTime = parseInt(startTime) + 5 * 60; // 5 minutes
            const currentTime = Math.floor(Date.now() / 1000);
            if (currentTime >= unlockTime) {
                document.getElementById("unlockTime").innerText = "Unlocked";
                document.getElementById("unstakeButton").disabled = false;
            } else {
                document.getElementById("unlockTime").innerText = new Date(unlockTime * 1000).toLocaleString();
                document.getElementById("unstakeButton").disabled = true;
            }
        }

        window.onload = init;
    </script>
</body>
</html>
